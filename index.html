<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Email + IP Display</title>
</head>
<body>
  <h2>Login</h2>
  <input type="email" id="email" placeholder="Enter your email">
  <button onclick="login()">Login</button>
  <button onclick="resetForm()">Reset</button>

  <h3>User Info</h3>
  <div id="userInfo"></div>

  <script>
    let savedIP = null;

    async function getIP() {
      try {
        const res = await fetch("https://api.ipify.org?format=json");
        const data = await res.json();
        savedIP = data.ip;
      } catch (error) {
        console.error("IP fetch error:", error);
        savedIP = "Unavailable";
      }
    }

    async function login() {
      const email = document.getElementById('email').value;
      if (!email) {
        alert("Please enter an email.");
        return;
      }

      // Get IP if not already fetched
      if (!savedIP) {
        await getIP();
      }

      document.getElementById('userInfo').innerHTML = `
        <p><strong>Email:</strong> ${email}</p>
        <p><strong>IP Address:</strong> ${savedIP}</p>
      `;
    }

    function resetForm() {
      document.getElementById('email').value = '';
      document.getElementById('userInfo').innerHTML = `
        <p><strong>Email:</strong> </p>
        <p><strong>IP Address:</strong> ${savedIP ?? "Unavailable"}</p>
      `;
    }

    // Fetch IP initially on load
    window.onload = getIP;
  </script>
</body>
</html>
